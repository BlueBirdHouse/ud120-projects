ud120-projects
==============

## Two-step Method for PIO Identifier Project of Udacity’s Intro to Machine Learning Class

This is an approach for the final project of Udacity’s intro to machine learning class. This project is to find persons of interest (PIOs) based on the financial data of Enron and the related mails with machine learning tools. The trained algorithm should learn the common points of the PIOs. There are 127 innocents and only 18 PIOs in the financial data, which is too few to train an algorithm. To reduce this problem, the approach is divided into two steps. The first step is to isolate the persons who are innocents certainly. This step will help to balance the number of persons between the innocents and the PIOs. The good guys are better protected. In the third step, we notice that one person can have only one record in the database but have written many mails. These mails will become a database enough big for training. We combine the mails that are written by PIOs and the mails that are from the innocents. The PIOs are few, so the combined mails still contain distinctly characters. These characters belong to entire PIOs not an individual. At last, the word frequency statistics of two mail group is used to isolate the people. For the second step, we got a recall score of 0.619 and a precision score of 0.591. The f1 and f2 scores are 0.605 and 0.613. The entire procedure has an accuracy score of 0.825. 

This is a machine learning assignment and not a deep learning one. The machine learning tools that are introduced in the class will play a constructive role if engineers, as human beings, can build efficient features for them. First, the data of Enron is official, and there is no zero entry in the form. It is reasonable to assume that these dash marks are zeros. If some dash marks are actually missed data points, this means that the data is irrelevant with the case. Both possibilities have nothing to do with following analyses. Under above assumption, there are some anomalies in the database. It is unusual because all the PIOs have no director’s fees. If a person gets paid by a company, it also means this person is responsible for this company. Having no director’s fees means that they are free from the company's failure, so they should not be PIOs. It leads a contradiction. One reasonable assumption is the PIOs would like to escape the punishment. Second, the self-serving action of PIOs is like the using unpublished information for trading. It means that they should have stock; unsurprisingly, all the PIOs’ total stock values are nonzero values. In addition, they all have zero restricted stock deferred values. At last, being a PIO means owning too much money. If a person has too much money, this person cannot help to spend money. Naturally, the PIOs have nonzero expenses, nonzero total payments and nonzero other values. If we feed above features into a classifier, which is down in ‘poi_finder_1.py’, it will give high scores on the persons who are innocents (the average precision score is 0.89 and the average recall score is 0.91). The classifier is not absolutely certain because we are not telling the algorithm what to learn. 

Above analysis shows it may be hard to identify a PIO, but it is relatively easy to isolate some persons who certainly are innocents. A person earns director’s fees, which means that the person has courage to be held jointly liable. If a person has no stock, he or she has no chance to corrupt. If a person never spent money, money is useless for this guy. These persons are absolutely not PIOs. We gave new labels for the data points in the financial database. A data point has a label zero means that this person is an absolute innocent, and a data point has a label one indicated that this person has a suspicion of becoming a PIO. Above mentioned features are transformed into binarize data (set feature values to 0 or 1) according to a threshold, which is down in ‘poi_finder.py’. The accuracy is 100% as we expect, and 77 innocents are protected from being mis-classified into PIOs. 

We rest our hopes to find these bad guys on the related mails after these innocents are removed. If they can tear apart the sixth biggest company of American in one month, they must be smart enough to mask their crimes. For example, they will not operate their stork often, so the Securities and Exchange Commission will not notice them. But, these PIOs collude to cause the bankruptcy. There should be a set of shared topics in their mails which cannot be hidden. To find these common topics for the PIOs, we put the mails that are written by PIOs in one bag and innocents’ mail in another (see ‘poi_finder2.py’ and ‘poi_finder3.py’). Each person has the same number of mails in their bags. After all the signatures are removed (see ‘poi_finder4.py’), we count the frequency of the word (use ‘TfidfVectorizer’). In this procedure, the words with the document frequency strictly higher than 0.9 and lower than 0.01 are removed.

In feature selection step, 10% most significant features are kept. The importance scores fall smoothly from the most significant word to the least significant word (see the outputs of ‘poi_finder4.py’), and 182 features are kept. At last, we have 467 data points in the training set and 117 data points in the test set. 

Our approach uses mails to train classifier rather than the financial data, which contain more data to get reliable classifier. The innocents are better protected by the artificial intelligence because the absolute innocent people are removed from the database firstly. We receive a classifier with a recall score of 0.619 and a precision score of 0.591. The f1 and f2 scores are 0.605 and 0.613. The entire procedure has an accuracy score of 0.825. All the associated code is compatible with Python 3.

## remark
This approach will read 'enron_mail_20150507.tar.gz' directly. Please put it into 'maildir'. No bother to unzip it.


